<div class="nav-bar sticky-top animate-fade-in" [class.scrolled]="isScrolled">
  <div class="container d-flex align-items-center justify-content-between">
    <div class="logo-wrapper" routerLink="/"></div>

    <div class="nav-content d-flex align-items-center gap-4">
      <!-- Desktop Navigation -->
      <ul class="nav-links d-none d-lg-flex align-items-center gap-2" *ngIf="authState.isLoggedIn$ | async">
        <li><a routerLink="/dashboard" routerLinkActive="active">Dashboard</a></li>
        <li><a routerLink="/courses" routerLinkActive="active">My Courses</a></li>
        <li><a routerLink="/post-course" routerLinkActive="active">Post a Course</a></li>
      </ul>

      <!-- Public Links (Optional, if you want something like 'About' always visible) -->
      <ul class="nav-links d-none d-lg-flex align-items-center gap-2" *ngIf="(authState.isLoggedIn$ | async) === false">
        <li><a routerLink="/landing" routerLinkActive="active">Home</a></li>
      </ul>

      <!-- Search Bar -->
      <div class="s-bar d-none d-md-flex">
        <i class="material-icons">search</i>
        <input type="text" placeholder="Search courses..." (keyup)="handleSearch($event.target)" />
      </div>

      <!-- Action Items -->
      <div class="action-items d-flex align-items-center gap-3">
        <!-- Theme Toggle -->
        <button class="theme-btn" (click)="toggleTheme()" title="Toggle Theme">
          <i class="material-icons">{{themeService.isDarkMode()?'light_mode':'dark_mode'}}</i>
        </button>

        <!-- Auth Buttons (Logged Out) -->
        <div *ngIf="(authState.isLoggedIn$ | async) === false" class="auth-buttons d-none d-md-flex gap-2">
          <button class="btn-outline btn-o-1" (click)="login('trainer', 'login')">Login</button>
          <button class="btn-fill btn-f-1" (click)="login('trainer', 'register')">Sign Up</button>
        </div>

        <!-- User Profile (Logged In) -->
        <div *ngIf="authState.isLoggedIn$ | async" class="profile-dropdown dropdown">
          <div class="profile-wrapper" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            <img [src]="(authState.employee$ | async)?.employee?.image || './assets/images/shared/default_emp_dp.svg'"
              alt="profile">
          </div>

          <ul class="dropdown-menu dropdown-menu-end glass-premium animate-fade-in">
            <li class="dropdown-header d-lg-none">
              <span class="user-name">{{ (authState.employee$ | async)?.employee?.firstname }} {{ (authState.employee$ |
                async)?.employee?.lastname }}</span>
            </li>
            <li>
              <a class="dropdown-item"
                [href]="'https://learner.talnova.io/profile?id=' + (authState.employee$ | async)?.employee?.id"
                target="_blank">
                <i class="material-icons">perm_identity</i>
                <span>Access Main Profile</span>
              </a>
            </li>
            <li>
              <a class="dropdown-item" routerLink="/my-profile">
                <i class="material-icons">settings</i>
                <span>Edit Profile</span>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>
            <li>
              <a class="dropdown-item" routerLink="/locked">
                <i class="material-icons">lock</i>
                <span>Lock Screen</span>
              </a>
            </li>
            <li>
              <button class="dropdown-item text-danger" (click)="logout()">
                <i class="material-icons">logout</i>
                <span>Logout</span>
              </button>
            </li>
          </ul>
        </div>

        <!-- Mobile Menu Toggle -->
        <button class="menu-toggle d-lg-none" type="button" (click)="toggleMobileMenu()">
          <i class="material-icons">menu</i>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Content -->
  <div class="mobile-menu glass-premium animate-slide-in" *ngIf="isMobileMenuOpen">
    <div class="mobile-nav-links">
      <ng-container *ngIf="authState.isLoggedIn$ | async">
        <a routerLink="/dashboard" (click)="toggleMobileMenu()">Dashboard</a>
        <a routerLink="/courses" (click)="toggleMobileMenu()">My Courses</a>
        <a routerLink="/post-course" (click)="toggleMobileMenu()">Post a Course</a>
      </ng-container>
      <ng-container *ngIf="(authState.isLoggedIn$ | async) === false">
        <a routerLink="/landing" (click)="toggleMobileMenu()">Home</a>
      </ng-container>
      <hr class="divider">
      <div class="mobile-s-bar">
        <i class="material-icons">search</i>
        <input type="text" placeholder="Search..." (keyup)="handleSearch($event.target)" />
      </div>
    </div>
  </div>

  <!-- Search Results Dropdown -->
  <div class="search-results-wrapper" *ngIf="openSearchResults">
    <div class="search-result" *ngFor="let r of filterSearchResults(); let i = index"
      [style.animation-delay]="i * 0.05 + 's'">
      <a (click)="navigateToSearchResult(r.id)">{{r.name}}</a>
    </div>
    <div class="not-found" *ngIf="filterSearchResults().length <= 0">No results found.</div>
  </div>
</div>